<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[smalldragonluo]]></title>
  <subtitle><![CDATA[不卑不亢就是亢]]></subtitle>
  <link href="/atom.xml" rel="self"/>
  <link href="http://blog.smalldragonluo.com/"/>
  <updated>2016-03-04T03:51:41.000Z</updated>
  <id>http://blog.smalldragonluo.com/</id>
  
  <author>
    <name><![CDATA[smalldragonluo]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[「淘宝技术部」内推开始啦~]]></title>
    <link href="http://blog.smalldragonluo.com/2016/03/04/%E3%80%8C%E6%B7%98%E5%AE%9D%E6%8A%80%E6%9C%AF%E9%83%A8%E3%80%8D%E5%86%85%E6%8E%A8%E5%BC%80%E5%A7%8B%E5%95%A6/"/>
    <id>http://blog.smalldragonluo.com/2016/03/04/「淘宝技术部」内推开始啦/</id>
    <published>2016-03-04T03:27:12.000Z</published>
    <updated>2016-03-04T03:51:41.000Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>贴吧发帖被系统删，只能在这里发了…</p>
</blockquote>
<p><strong>阿里巴巴集团2016年春季实习生招聘-内部推荐火热启动！</strong></p>
<p><img src="http://ww3.sinaimg.cn/large/a26409a6gw1eupjy5o032j20fk07840e.jpg" alt="招聘海报"></p>
<p>淘宝技术部，是支撑淘宝业务发展的核心研发团队，负责各个细分行业市场、跨境电商、商家运营、生活服务、互动内容及社区等全业务线，以及交易基础平台、内容平台、会员平台、招商平台、营销平台、建站系统等核心业务平台的开发/前端/测试等工作，支撑淘宝双十一/双十二大促的稳定性和高并发业务场景，服务全球几亿用户的吃穿住行消费需求。</p>
<p>阿里巴巴集团2016实习生招聘官网：<a href="https://campus.alibaba.com/trainNotice.htm" target="_blank" rel="external">https://campus.alibaba.com/trainNotice.htm</a></p>
<h4 id="内推岗位">内推岗位</h4><p>研发工程师JAVA（杭州/北京）、客户端开发工程师（杭州）、前端开发工程师（杭州/北京）、测试工程师（杭州）、算法工程师（杭州）<br>岗位详情：<a href="https://campus.alibaba.com/traineePositionList.htm" target="_blank" rel="external">https://campus.alibaba.com/traineePositionList.htm</a><br>（注：此处只包含淘宝技术部岗位）</p>
<h4 id="内推对象">内推对象</h4><p>2017年1月1日及以后毕业的同学（通常为2017届及以后毕业的同学）</p>
<h4 id="内推时间">内推时间</h4><p>即日起至2016年3月31日</p>
<h4 id="联系方式">联系方式</h4><p>感兴趣的同学，请把简历发送至我的邮箱（xiaolong.lxl@alibaba-inc.com）QQ：594506262</p>
<h4 id="tips">tips</h4><p>内推可以免笔试直接面试，即便未通过，也可以参加正常校招</p>
]]></content>
    <summary type="html">
    <![CDATA[这是一个广告贴]]>
    
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[一个简单的 JS 模板引擎]]></title>
    <link href="http://blog.smalldragonluo.com/2016/02/05/%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84-JS-%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E/"/>
    <id>http://blog.smalldragonluo.com/2016/02/05/一个简单的-JS-模板引擎/</id>
    <published>2016-02-05T02:19:25.000Z</published>
    <updated>2016-03-07T11:03:03.000Z</updated>
    <content type="html"><![CDATA[<blockquote>
<p>快过年了，需求不饱和，有时间写写博客。</p>
</blockquote>
<h3 id="What’s_this?">What’s this?</h3><p>这是一个清爽的 JavaScript 语法模板引擎，使用自带的 JavaScript 解释器，无中间语法，压缩后仅 0.45 kb。</p>
<p>思路：</p>
<ul>
<li>拆分语句与表达式（一次处理，提高性能）</li>
<li>拼装 compiler 函数</li>
<li>转义 html 中的单引号与转义符，保留函数与 html 格式</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Tpl</span>(<span class="params">tpl</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 关于传递 RegExp https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/split</span></span><br><span class="line">  <span class="keyword">var</span> snippet = tpl.split(<span class="regexp">/(?=&lt;%)|(%&gt;)/</span>);</span><br><span class="line">  <span class="keyword">var</span> mCode = [</span><br><span class="line">    <span class="string">'var _tplSnippet = [];'</span>,</span><br><span class="line">    <span class="string">'with(_tplData) &#123;'</span></span><br><span class="line">  ];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; snippet.length; ++i) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> snippet[i] !== <span class="string">'undefined'</span> &amp;&amp; snippet[i] !== <span class="string">'%&gt;'</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (snippet[i].substring(<span class="number">0</span>, <span class="number">2</span>) === <span class="string">'&lt;%'</span>) &#123;</span><br><span class="line">        <span class="comment">// 如果是表达式</span></span><br><span class="line">        <span class="keyword">if</span> (snippet[i].charAt(<span class="number">2</span>) === <span class="string">'='</span>) &#123;</span><br><span class="line">          mCode.push(snippet[i].replace(<span class="regexp">/&lt;%=((\s|.)+)/g</span>, <span class="string">'_tplSnippet.push($1);'</span>));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// 如果是语句</span></span><br><span class="line">          mCode.push(snippet[i].replace(<span class="regexp">/&lt;%((\s|.)+)/g</span>, <span class="string">'$1'</span>));</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 如果是 html</span></span><br><span class="line">        mCode.push(<span class="string">'_tplSnippet.push(\''</span> + snippet[i].replace(<span class="regexp">/\\/g</span>, <span class="string">'\\\\'</span>).replace(<span class="regexp">/'/g</span>, <span class="string">'\\\''</span>).replace(<span class="regexp">/\n/g</span>, <span class="string">'\\n'</span>) + <span class="string">'\');'</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  mCode.push(<span class="string">'&#125;'</span>, <span class="string">'return _tplSnippet.join(\'\');'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Function</span>(<span class="string">'_tplData'</span>, mCode.join(<span class="string">''</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ShowCase">ShowCase</h3><p>你可以在这里编辑模板与数据</p>
<textarea class="J_Tpl custom-tpl"></textarea>

<textarea class="J_Data custom-data"></textarea>

<button class="J_Compile custom-btn">运行</button>

<pre class="J_Result custom-result"></pre>

<h3 id="性能">性能</h3><p>我做了一些测试，结果证明，即便是模板中包含大量复杂的业务逻辑，构建渲染函数过程的性能消耗也是微乎其微的，查看 TimeLine 时间大概在 1 毫秒左右。<br>因此可以见得，团队使用离线编译原生 JavaScript 语法的模板，主要是为了自动化、模块化以及安全考虑，而不是性能。</p>
<style>
  .custom-tpl, .custom-data {
    width: 100%;
    height: 310px;
    outline: none;
    resize: vertical;
    padding: 4px 8px;
    border-radius: 7px;
    border: 1px solid #DDD;
  }
  .custom-btn {
    outline: none;
    display: inline-block;
    padding: 3px 20px 3px;
    line-height: 30px;
    color: #444;
    font-size: 13px;
    background: white;
    border: 1px solid #ddd;
  }
</style>

<script class="J_TplStore" type="text/html">
  <ul>
   <% for(var i = 0; i < data.length; i++) { %>
     <li>
     <% if(i === 1) { %>
     <i> * </i>
     <% } %>
     <%= data[i] %>
     </li>
   <% } %>
  </ul>
</script>

<script class="J_DataStore" type="text/html">
  {
    "data": [1, 2, 3]
  }
</script>

<script>
(function tmp(){
  if(window.$) {
    function Tpl(tpl) {
          // 关于传递 RegExp https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/split
          var snippet = tpl.split(/(?=<%)|(%>)/);
          var mCode = [
            'var _tplSnippet = [];',
            'with(_tplData) {'
          ];

          for (var i = 0; i < snippet.length; ++i) {
            if (typeof snippet[i] !== 'undefined' && snippet[i] !== '%>') {
              if (snippet[i].substring(0, 2) === '<%') {
                // 如果是表达式
                if (snippet[i].charAt(2) === '=') {
                  mCode.push(snippet[i].replace(/<%=((\s|.)+)/g, '_tplSnippet.push($1);'));
                } else {
                  // 如果是语句
                  mCode.push(snippet[i].replace(/<%((\s|.)+)/g, '$1'));
                }
              } else {
                // 如果是 html
                mCode.push('_tplSnippet.push(\'' + snippet[i].replace(/\\/g, '\\\\').replace(/'/g, '\\\'').replace(/\n/g, '\\n') + '\');');
              }
            }
          }

          mCode.push('}', 'return _tplSnippet.join(\'\');');

          return new Function('_tplData', mCode.join(''));
        }

        $('.J_Tpl').val($('.J_TplStore').html());
        $('.J_Data').val($('.J_DataStore').html());

        $('.J_Compile').on('click', function(){
          if(!JSON) {
            $('.J_Result').text('你的浏览器没有 JSON 对象，请切换浏览器再试');
            return;
          }

          var compiler, data, t, cTime, rTime;

          try {
            t = new Date().getTime();
            compiler = Tpl($('.J_Tpl').val());
            cTime = new Date().getTime() - t;
          } catch(e) {
            $('.J_Result').text('模板格式错误\n' + e.stack);
            return;
          }

          try {
            data = JSON.parse($('.J_Data').val());
          } catch(e) {
            $('.J_Result').text('数据格式错误\n' + e.stack);
            return;
          }

          try {
            t = new Date().getTime();
            var html = compiler(data);
            rTime = new Date().getTime() - t;
            $('.J_Result').text('<!-- 创建渲染函数用时：' + cTime + ' ms, 渲染用时：' + rTime + ' ms -->\n' + html);
          } catch(e) {
            $('.J_Result').text('渲染错误\n' + e.stack);
            return;
          }
        }).trigger('click');
  } else {
    setTimeout(function() {
      tmp();    
    }, 16.7);
  }
})();
</script>
]]></content>
    <summary type="html">
    <![CDATA[本文讲述了如何用简单的代码实现一个 JavaScript 语法模板引擎]]>
    
    </summary>
    
      <category term="JavaScript" scheme="http://blog.smalldragonluo.com/tags/JavaScript/"/>
    
      <category term="模板引擎" scheme="http://blog.smalldragonluo.com/tags/%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E/"/>
    
      <category term="正则表达式" scheme="http://blog.smalldragonluo.com/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    
      <category term="前端技术" scheme="http://blog.smalldragonluo.com/categories/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[regeneratorRuntime is not defined]]></title>
    <link href="http://blog.smalldragonluo.com/2016/01/25/regeneratorRuntime-is-not-defined/"/>
    <id>http://blog.smalldragonluo.com/2016/01/25/regeneratorRuntime-is-not-defined/</id>
    <published>2016-01-25T14:09:02.000Z</published>
    <updated>2016-02-06T06:00:35.000Z</updated>
    <content type="html"><![CDATA[<h4 id="起因">起因</h4><p>最近在开发团队自动化工具：一个基于 Node.js 的本地 SDK，和一个配套 web UI。其实本来想一个 jQuery 解决问题，同事说，用 React，大家都用这个，都说好。我说，那咱们还等什么？<br>就这样最终选择了 React.js，然后理所当然地加上了 React Router，Redux，Webpack，ES6。为了和前端保持一致，服务端也跟着使用了 ES6，这是事件的起因。</p>
<p>在 OS X 上整个开发过程比较顺利，但由于外包同学需要使用 windows，所以我需要做兼容测试。当某一天我把 SDK 放到 windows 上运行的时候卧槽它居然！！你猜怎么着？？</p>
<p>居然跑不起来。跑起来我也就不用写了。</p>
<p>根据 stack 信息，一开始以为是 Babel 的问题，最后经过仔细排查，发现是 SDK 依赖的宿主环境，而这个环境我没办法修改，因此我只能另寻出路。</p>
<p>没法使用 babel/register，那就只能将 ES6 编译成 ES5，然后 polyfill 一下。</p>
<p>我使用的 Babel 版本为 5.8.3，默认提供转换所有已经支持的最新 ES 特性，6.x 需要手动安装需要使用的特性或使用预置集（preset）。目前提供有 6 个预置集，分别是</p>
<ul>
<li>es2015</li>
<li>stage-0</li>
<li>stage-1</li>
<li>stage-2</li>
<li>stage-3</li>
<li>react</li>
</ul>
<p>我选择了 es2015，包含丰富的插件，支持包括 arrow function，Generator function，以及 Node 4.x 目前并不支持的 Module import。</p>
<h4 id="经过">经过</h4><p>使用官方指定的 gulp-babel 编译后提示</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ReferenceError: regeneratorRuntime is not defined.</span><br></pre></td></tr></table></figure>
<p>我思索良久，仍不解心头之惑 —— 为什么，为什么他们要把一个变量定义的这么长？</p>
<p>凭着我的聪明才智，我翻看 build 之后的文件，发现每个头部都添加了 <code>&#39;use strict;&#39;</code>，难道，这就是祸乱的根源？</p>
<p>通过 Google 之，发现这个 <a href="https://phabricator.babeljs.io/T6676" target="_blank" rel="external">issue</a> 里有人遇到同样的问题。由于 es2015 已经自带了 transform-regenerator，所以我猜测由于严格模式导致 <code>regeneratorRuntime</code> 这个全局变量声明失败，我于是注释掉了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node_modules/babel-preset-es2015/node_modules/babel-plugin-transform-es2015-modules-commonjs/lib/index.js</span><br></pre></td></tr></table></figure>
<p>第 130 行的 </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">inherits: <span class="built_in">require</span>(<span class="string">"babel-plugin-transform-strict-mode"</span>)</span><br></pre></td></tr></table></figure>
<p>运行成功！</p>
<p>也可以在需要使用 generator 的代码中引入 <code>babel-polyfill</code>，但这在 Babel 5 中是不必要的，不够整洁。</p>
<p>如果你不想转换 generator 函数，可以注释掉 <code>babel-plugin-transform-regenerator</code>。</p>
]]></content>
    <summary type="html">
    <![CDATA[最近在开发团队自动化工具：一个基于 Node.js 的本地 SDK，和一个配套 web UI。其实本来想一个 jQuery 解决问题，同事说，用 React，大家都用这个，都说好。我说，那咱们还等什么？]]>
    
    </summary>
    
      <category term="Babel" scheme="http://blog.smalldragonluo.com/tags/Babel/"/>
    
      <category term="Gulp" scheme="http://blog.smalldragonluo.com/tags/Gulp/"/>
    
      <category term="JavaScript" scheme="http://blog.smalldragonluo.com/tags/JavaScript/"/>
    
      <category term="前端技术" scheme="http://blog.smalldragonluo.com/categories/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[浅析语法分析树]]></title>
    <link href="http://blog.smalldragonluo.com/2015/12/06/%E6%B5%85%E6%9E%90%E8%AF%AD%E6%B3%95%E5%88%86%E6%9E%90%E6%A0%91/"/>
    <id>http://blog.smalldragonluo.com/2015/12/06/浅析语法分析树/</id>
    <published>2015-12-06T14:53:42.000Z</published>
    <updated>2015-12-26T15:08:52.000Z</updated>
    <content type="html"><![CDATA[<h4 id="语法分析树">语法分析树</h4><p>语法分析树，一般称它为具体语法树，相应的语法称之为该语言的具体语法。语法分析树和产生式相对应，用于展现从文法开始符号推导符号串的过程。<br>语法分析树是一种树形结构，是语法制导翻译中不可缺少的因素。</p>
<h4 id="节点形式">节点形式</h4><ul>
<li>树的根节点是文法的开始符号</li>
<li>叶子节点为终结符号或者 ∈</li>
<li>内部节点的标号为非终结符号</li>
</ul>
<h4 id="图示">图示</h4><p>以下列产生式为例</p>
<ul>
<li>A -&gt; + A A</li>
<li>A -&gt; - A A</li>
<li>A -&gt; digit</li>
</ul>
<p>+ 1 - 2 3 对应的语法分析树是</p>
<p><img src="/assets/st.jpg" alt=""></p>
]]></content>
    <summary type="html">
    <![CDATA[<h4 id="语法分析树">语法分析树</h4><p>语法分析树，一般称它为具体语法树，相应的语法称之为该语言的具体语法。语法分析树和产生式相对应，用于展现从文法开始符号推导符号串的过程。<br>语法分析树是一种树形结构，是语法制导翻译中不可缺少的因素。</p>
<h4 id=]]>
    </summary>
    
      <category term="编译器" scheme="http://blog.smalldragonluo.com/tags/%E7%BC%96%E8%AF%91%E5%99%A8/"/>
    
      <category term="语法分析树" scheme="http://blog.smalldragonluo.com/tags/%E8%AF%AD%E6%B3%95%E5%88%86%E6%9E%90%E6%A0%91/"/>
    
      <category term="前端技术" scheme="http://blog.smalldragonluo.com/categories/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/"/>
    
      <category term="编译" scheme="http://blog.smalldragonluo.com/categories/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/%E7%BC%96%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[浅析上下文无关文法]]></title>
    <link href="http://blog.smalldragonluo.com/2015/12/06/%E6%B5%85%E6%9E%90%E4%B8%8A%E4%B8%8B%E6%96%87%E6%97%A0%E5%85%B3%E6%96%87%E6%B3%95/"/>
    <id>http://blog.smalldragonluo.com/2015/12/06/浅析上下文无关文法/</id>
    <published>2015-12-06T14:07:51.000Z</published>
    <updated>2015-12-06T14:52:12.000Z</updated>
    <content type="html"><![CDATA[<p>在编译器的分析部分，需要使用一种表示方法用于描述程序语言的语法，上下文无关文法是表示方法中的一种。</p>
<h4 id="文法定义">文法定义</h4><h5 id="组成要素">组成要素</h5><p>一个上下文无关文法由四个元素组成：</p>
<ul>
<li>一个终结符号集合，终结符号是文法中最基本的符号，可以将其理解为最小的符号，有时也称为词法单元</li>
<li>一个非终结符号集合，又称「语法变量」，是终结符号的集合</li>
<li>一个产生式集合，产生式用来表示某种构造的书写形式，由产生式头，箭头，产生式体组成，稍后会有详细介绍</li>
<li>一个开始符号，此符号为非终结符号</li>
</ul>
<h5 id="产生式">产生式</h5><p>以 JAVA 语句为例子，一个 if-else 的语句一般是以下形式：</p>
<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="type">expr</span>) <span class="type">stmt</span> <span class="keyword">else</span> <span class="type">stmt</span></span><br></pre></td></tr></table></figure>
<p>上述语句可以用一个产生式表示为：</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">stmt </span>-&gt; <span class="preprocessor">if</span> (expr) <span class="keyword">stmt </span><span class="preprocessor">else</span> <span class="keyword">stmt</span></span><br></pre></td></tr></table></figure>
<p>这是一个语句的描述，其中 if，else 称为终结符号，可以由一个词法单元表示。expr，stmt 属于非终结符号，因为其可以由另一个产生式表示。</p>
<p>举个简单的例子，接下来通过上下文无关文法描述一个简单的语法–乘除过程 p：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">p     -&gt; p * digit</span><br><span class="line">p     -&gt; p / digit</span><br><span class="line">p     -&gt; digit</span><br><span class="line">digit -&gt; <span class="number">0</span>|<span class="number">1</span>|<span class="number">2</span>|<span class="number">3</span>|<span class="number">4</span>|<span class="number">5</span>|<span class="number">6</span>|<span class="number">7</span>|<span class="number">8</span>|<span class="number">9</span></span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[在编译器的分析部分，需要使用一种表示方法用于描述程序语言的语法，上下文无关文法是表示方法中的一种。]]>
    
    </summary>
    
      <category term="上下文无关文法" scheme="http://blog.smalldragonluo.com/tags/%E4%B8%8A%E4%B8%8B%E6%96%87%E6%97%A0%E5%85%B3%E6%96%87%E6%B3%95/"/>
    
      <category term="编译器" scheme="http://blog.smalldragonluo.com/tags/%E7%BC%96%E8%AF%91%E5%99%A8/"/>
    
      <category term="前端技术" scheme="http://blog.smalldragonluo.com/categories/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/"/>
    
      <category term="编译" scheme="http://blog.smalldragonluo.com/categories/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/%E7%BC%96%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Designed By smalldragonluo]]></title>
    <link href="http://blog.smalldragonluo.com/2015/12/05/Designed%20By%20smalldragonluo/"/>
    <id>http://blog.smalldragonluo.com/2015/12/05/Designed By smalldragonluo/</id>
    <published>2015-12-05T08:24:29.000Z</published>
    <updated>2015-12-05T10:59:55.000Z</updated>
    <content type="html"><![CDATA[<p>这是一款我在大学设计的 APP UI，现在看来，还有许多细节不够好，但毕竟是自己的… 儿子？噢，这个比喻不太好，我其实是想表达：虽然设计平庸，但好歹是一点一滴创造出来的，我应该给他留下回忆。</p>
<p>一开始想这样</p>
<p><img src="/assets/app.jpg" alt=""></p>
<p>后来改成了</p>
<p><img src="/assets/index.png" alt=""></p>
<p>再后来改成了</p>
<p><img src="/assets/index2.png" alt=""></p>
<p>菜单</p>
<p><img src="/assets/menu.png" alt=""></p>
<p>订单列表</p>
<p><img src="/assets/order.png" alt=""></p>
<p>订单详情</p>
<p><img src="/assets/order_detail.png" alt=""></p>
<p>个人主页</p>
<p><img src="/assets/personal.png" alt=""></p>
<p>IM</p>
<p><img src="/assets/talk.png" alt=""></p>
<p><img src="/assets/confirm.png" alt=""></p>
<p><img src="/assets/map.png" alt=""></p>
<p><img src="/assets/opt.png" alt=""></p>
]]></content>
    <summary type="html">
    <![CDATA[这是一款我在大学设计的 APP UI，现在看来，还有许多细节不够好，但毕竟是自己的... 儿子？噢，这个比喻不太好，我其实是想表达：虽然设计平庸，但好歹是一点一滴创造出来的，我应该给他留下回忆。]]>
    
    </summary>
    
      <category term="UI设计" scheme="http://blog.smalldragonluo.com/tags/UI%E8%AE%BE%E8%AE%A1/"/>
    
      <category term="UI设计" scheme="http://blog.smalldragonluo.com/categories/UI%E8%AE%BE%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[一个编译器的主要流程]]></title>
    <link href="http://blog.smalldragonluo.com/2015/12/03/%E4%B8%80%E4%B8%AA%E7%BC%96%E8%AF%91%E5%99%A8%E7%9A%84%E4%B8%BB%E8%A6%81%E6%B5%81%E7%A8%8B/"/>
    <id>http://blog.smalldragonluo.com/2015/12/03/一个编译器的主要流程/</id>
    <published>2015-12-03T09:51:29.000Z</published>
    <updated>2015-12-04T02:00:33.000Z</updated>
    <content type="html"><![CDATA[<h4 id="编译器简介">编译器简介</h4><p>编译器的作用是将源程序翻译成另一种语言，例如，将 JAVA 代码编译为二进制 .class 文件以跨平台运行，将 JSP 文件编译成 Servlet 代码，将 HTML 模板编译为 JavaScript 代码，这和解释型语言（几乎所有的脚本语言）有所不同，后者是在运行时直接解释运行。<br>编译器的设计目标是：</p>
<ul>
<li><p>极致的性能优化，这通常是最具挑战的目标</p>
</li>
<li><p>高效编译，即编译应该控制在合理的时间内</p>
</li>
<li><p>正确的优化，即不能改变源程序的含义</p>
</li>
</ul>
<p>一个语言的编译器分为两个部分，一个是分析部分，一个是综合部分，我们称分析部分为编译器的前端，综合部分为编译器的后端。分析部分包括：</p>
<h4 id="分析部分">分析部分</h4><ul>
<li><p>词法分析<br>这一步将源程序组织成词素序列，并输出词法单元，词法单元类似 &lt;id, index&gt;，index 为符号表对应的索引。</p>
</li>
<li><p>语法分析<br>根据词法单元生成可表示语法结构的中间形式，例如语法树，这个步骤会帮助编译器在接下来的过程中对源程序进行分析。</p>
</li>
<li><p>语义分析<br>这一步骤会做类型检查，如果出现类型错误，编译器会在这个阶段发现。如果程序语言支持自动类型转换，会将某些数据类型做转换。这一阶段会分析更加细致的语义信息，并补充符号表或语法树。</p>
</li>
</ul>
<h4 id="综合部分">综合部分</h4><p>这一部分会做很多更加复杂的工作，包括中间代码生成（生成中间表示会存在整个编译周期）和优化工作。随着计算机架构的不断更新，多核 CPU 的出现，如何使计算机指令执行效率得到提高，充分利用机器性能成为编译器的目标与挑战。<br>这一阶段会生成易于生成，易于翻译成目标机器代码的中间代码，例如『三地址代码』：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="setting">t1 = <span class="value">inttofloat(<span class="number">60</span>)</span></span></span><br><span class="line"><span class="setting">t2 = <span class="value">id3 * t1</span></span></span><br><span class="line"><span class="setting">t3 = <span class="value">id2 + t2</span></span></span><br><span class="line"><span class="setting">id1 = <span class="value">t3</span></span></span><br></pre></td></tr></table></figure>
<p>并优化，生成目标语言，如汇编语言。然后由汇编器生成目标机器代码。</p>
<p>通常，在分析部分开始之前，还会有预处理器，所做的工作是将『宏』转换到代码语句中。</p>
]]></content>
    <summary type="html">
    <![CDATA[编译器的作用是将源程序翻译成另一种语言，例如，将 JAVA 代码编译为二进制 .class 文件以跨平台运行，将 JSP 文件编译成 Servlet 代码，将 HTML 模板编译为 JavaScript 代码，这和解释型语言（几乎所有的脚本语言）有所不同，后者是在运行时直接解释运行。]]>
    
    </summary>
    
      <category term="编译器" scheme="http://blog.smalldragonluo.com/tags/%E7%BC%96%E8%AF%91%E5%99%A8/"/>
    
      <category term="前端技术" scheme="http://blog.smalldragonluo.com/categories/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/"/>
    
      <category term="编译" scheme="http://blog.smalldragonluo.com/categories/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/%E7%BC%96%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Process-Killer，an Alfred Workflow]]></title>
    <link href="http://blog.smalldragonluo.com/2015/11/29/Process-Killer%20%E4%B8%80%E4%B8%AA%20Alfred%20Workflow/"/>
    <id>http://blog.smalldragonluo.com/2015/11/29/Process-Killer 一个 Alfred Workflow/</id>
    <published>2015-11-29T12:39:00.000Z</published>
    <updated>2015-12-06T14:19:03.000Z</updated>
    <content type="html"><![CDATA[<p><a href="https://www.alfredapp.com/" target="_blank" rel="external">Alfred</a> 是一个 Mac 上的效率工具，官网对其的定义是：</p>
<blockquote>
<p>Alfred is an award-winning app for Mac OS X which boosts your efficiency with hotkeys and keywords. Search your Mac and the web effortlessly, and control your Mac using customised actions with the Powerpack.<br>Alfred 是一个 Mac 上的获奖应用，可以通过快捷键和关键字提高你的效率，除此之外，还可以高效地搜索本地和网络，通过 Powerpack 自定义动作控制你的电脑。</p>
</blockquote>
<h4 id="什么是_Process-Killer？">什么是 Process-Killer？</h4><p>回到正题，Process-Killer 是一个我编写的 Alfred 插件（其准确的定义应该是 <strong>customised actions</strong>），功能是根据你输入的进程名称或者 PID 或者端口号结束对应进程。</p>
<p>例如</p>
<p><img src="https://camo.githubusercontent.com/a2e1ceee9d2199adcca3a9f3118da1682d8cc4a7/68747470733a2f2f696d672e616c6963646e2e636f6d2f7470732f5442314b5545414b465858585861735870585858585858585858582d3538342d3232332e6a7067" alt=""></p>
<p>如你所见，输入关键字 kill，会进入匹配模式，你可以输入进程名称，PID 或者 -i 端口号，列表会显输出对应的进程，选中并确定，一个进程就将殒命，消失于宇宙的浩瀚之中（我决定以后给他加上一声惨叫，当然这是开玩笑的）。<br>你可能注意到，每个 item 的下方会显示此进程运行的参数，这对于运行多个相同的命令来说是很有帮助的。例如你打开了多个 Node.js 进程，通过这个插件可以很方便地进行区分。</p>
<h4 id="Install">Install</h4><p>如何安装呢？</p>
<ol>
<li>首先查看 <a href="https://github.com/smalldragonluo/process-killer" target="_blank" rel="external">Process-Killer</a> 仓库，下载 <strong>Process Killer.alfredworkflow</strong> 文件</li>
<li>打开 Alfred 面板，点设置，进入 Workflow，将 <strong>Process Killer.alfredworkflow</strong> 拖入左侧列表，至此，安装完成，就是这么轻松，就是这么简单。</li>
</ol>
<h4 id="工作原理">工作原理</h4><p>这个插件使用了 Node.js 作为开发语言，具体工作流程打开 Alfred 面板可以看到：</p>
<p><img src="/assets/C6671052-55E6-4EEA-A5EE-FCD9C8D93E17.png" alt=""></p>
<p>看到这里你肯定会惊讶：『这个图标真他妈好看』。真不好意思，这是我画的，你可以在其他产品中使用这枚图标，这是免费的。</p>
<h5 id="内容过滤">内容过滤</h5><p>插件的入口是一个 Script Filter，顾名思义，是一个脚本过滤器，用于生成可以显示在面板的内容，出此之外还有 keyword，File Filter 等。</p>
<p>首先，Script Filter 通过 shell 调用了 Node.js 服务</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/bin/<span class="keyword">node</span><span class="identifier"> </span><span class="title">&lt;&lt;-'CODE</span>'</span><br><span class="line">require(<span class="string">"./processFilter"</span>)(<span class="string">"&#123;query&#125;"</span>);</span><br><span class="line">CODE</span><br></pre></td></tr></table></figure>
<p>其中，<code>query</code> 是面板传递的参数，这一步的目地是要通过 Node.js 生成可供面板显示的内容数据，输出格式为 XML，这里我使用了 <a href="http://npm.taobao.org/package/xtpl" target="_blank" rel="external">xtpl</a> 来输出，XML 格式大家看代码就知道意思了。<br>我还是提一下吧，我并不是为了凑字数。一个简单的 XML 格式是这样的：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">items</span>&gt;</span></span><br><span class="line">  &#123;&#123;#each(items)&#125;&#125;</span><br><span class="line">  <span class="tag">&lt;<span class="title">item</span> <span class="attribute">uid</span>=<span class="value">"&#123;&#123;name&#125;&#125;"</span> <span class="attribute">arg</span>=<span class="value">"&#123;&#123;pid&#125;&#125;"</span> <span class="attribute">valid</span>=<span class="value">"yes"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">title</span>&gt;</span>&#123;&#123;name&#125;&#125;<span class="tag">&lt;/<span class="title">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">subtitle</span>&gt;</span>&#123;&#123;args&#125;&#125;<span class="tag">&lt;/<span class="title">subtitle</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">icon</span> &#123;&#123;#<span class="attribute">if</span>(<span class="attribute">isApp</span>)&#125;&#125;<span class="attribute">type</span>=<span class="value">"fileicon"</span><span class="value">&#123;&#123;</span>/<span class="attribute">if</span>&#125;&#125;&gt;</span>&#123;&#123;icon&#125;&#125;<span class="tag">&lt;/<span class="title">icon</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">item</span>&gt;</span></span><br><span class="line">  &#123;&#123;/each&#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="title">items</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>其中，uid 是用来标记 item 的唯一属性，选择次数越多，会越将其靠前显示；arg 是传递到下一步的参数；valid 代表可以选定，你可以输出一个不可选定的 item 用来提示用户信息。<br><code>type=&quot;fileicon&quot;</code> 说明这是一个应用，可以直接使用 APP 的图标，value 为 APP 路径。</p>
<p>如何抽出进程的 command 与 args 是个问题，因为 shell 输出的字段以空格分割，而 command 本身也包含空格，因此我使用 child_process 执行了两次 ps 命令，分别取出 command 与 args，并将 args 做为 map 通过 PID 查询。  </p>
<h5 id="执行动作">执行动作</h5><p>Run Script 步骤会接受某个 item 的参数 arg，这个 item 是面板选定的元素。接下来执行另一段代码：</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/bin/<span class="keyword">node</span><span class="identifier"> </span><span class="title">&lt;&lt;-'CODE</span>'</span><br><span class="line">require(<span class="string">"./action"</span>)(<span class="string">"&#123;query&#125;"</span>);</span><br><span class="line">CODE</span><br></pre></td></tr></table></figure>
<p>这段代码会根据 PID，对此进程发送信号 <strong>TERM(termination signal)</strong>，5 秒后发送信号 <strong>KILL(non-ignorable kill)</strong>。</p>
<h4 id="后记">后记</h4><p>其实，我并不用太多 Alfred 的功能，大部分自带的 Spotlight 也能做，唯一使用的就只有 Workflows 了，这对开发来说还是比较方便的，希望这个插件可以帮助到你~</p>
<h4 id="参考链接">参考链接</h4><p><a href="https://developer.apple.com/library/prerelease/mac/documentation/Darwin/Reference/ManPages/man1/ps.1.html" target="_blank" rel="external">ps(1) Mac OS X Manual Page</a><br><a href="http://computers.tutsplus.com/tutorials/alfred-workflows-for-advanced-users--mac-60963" target="_blank" rel="external">Alfred Workflows for Advanced Users</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p><a href="https://www.alfredapp.com/" target="_blank" rel="external">Alfred</a> 是一个 Mac 上的效率工具，官网对其的定义是：</p>
<blockquote>
<p>Alfred is an ]]>
    </summary>
    
      <category term="Alfred" scheme="http://blog.smalldragonluo.com/tags/Alfred/"/>
    
      <category term="前端技术" scheme="http://blog.smalldragonluo.com/categories/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/"/>
    
      <category term="实用工具" scheme="http://blog.smalldragonluo.com/categories/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[使用 NodeBB 搭建论坛]]></title>
    <link href="http://blog.smalldragonluo.com/2015/11/20/%E4%BD%BF%E7%94%A8%20NodeBB%20%E6%90%AD%E5%BB%BA%E8%AE%BA%E5%9D%9B/"/>
    <id>http://blog.smalldragonluo.com/2015/11/20/使用 NodeBB 搭建论坛/</id>
    <published>2015-11-20T14:00:50.000Z</published>
    <updated>2015-12-06T14:19:39.000Z</updated>
    <content type="html"><![CDATA[<h3 id="NodeBB">NodeBB</h3><p><a href="https://docs.nodebb.org/en/latest/" target="_blank" rel="external">NodeBB</a> 是一个基于 Node.js 的开源论坛，Metro UI 十分精美，它有以下特点：</p>
<ul>
<li>按照类目，标签，最新等进行帖子分类</li>
<li>MarkDown 支持</li>
<li>支持 WebSocket 实时推送消息</li>
<li>强大的后台管理</li>
<li>多样的皮肤</li>
<li>哈哈，我就不凑字数了</li>
</ul>
<p>虽然不如 <a href="http://www.discuz.net/forum.php" target="_blank" rel="external">Discuz</a> 功能强大，例如，没有验证码，但对于我来说已经够用了。</p>
<h3 id="ShowCase">ShowCase</h3><p>请访问 <strong><a href="//www.smalldragonluo.com">www.smalldragonluo.com</a></strong></p>
<h3 id="Install">Install</h3><p>我的 ECS 是放在阿里云，系统为 CentOS 6.5，NodeBB 的安装方式见 <a href="https://docs.nodebb.org/en/latest/installing/os/centos.html" target="_blank" rel="external">Installation by OS » CentOS 6/7</a></p>
<p>简单来说：</p>
<ul>
<li>首先需要安装 <a href="https://nodejs.org" target="_blank" rel="external">Node.js</a>，将编译好的 Node.js 放到环境变量即可</li>
<li>然后是 <a href="http://redis.io/" target="_blank" rel="external">Redis</a>，我使用的源码安装，你也可以切换成 <a href="https://www.mongodb.org/" target="_blank" rel="external">MongoDB</a>，这也是被支持的</li>
<li>哈哈，我就不凑字数了，你还是按照官方教程来吧… <a href="https://docs.nodebb.org/en/latest/installing/os/centos.html" target="_blank" rel="external">Installation by OS » CentOS 6/7</a></li>
</ul>
<p>请注意查看 NodeBB 的文档，Git 克隆下来后，先改下 NodeBB/install 里面的配置，例如修改页尾，论坛分类等等，你也可以安装后在管理界面修改</p>
<p>注意在安装 NodeBB 时可能会遇到这个错误：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ error This version of node/NAN/v8 requires a C++<span class="number">11</span> compiler</span><br></pre></td></tr></table></figure>
<p>原因是目前 CentOS 6.5 的云主机 C++ 编译器版本普遍较低，如你遇到安装时编译 mmmagic 模块报错，请升级 g++ 至 4.8 版本，包含 C++ 11。参考 <a href="http://superuser.com/questions/381160/how-to-install-gcc-4-7-x-4-8-x-on-centos" target="_blank" rel="external">CentOS g++ 4.8 install</a></p>
<h3 id="建议">建议</h3><ul>
<li>请修改 Redis 密码以防止外部攻击，或者限制 IP 访问</li>
<li>增加 Nginx，主要是为了提高静态资源性能，防止 DDos 攻击，负载均衡（就是要这么认真）</li>
<li>SFTP 我推荐一个 Mac 的软件：<a href="https://cyberduck.io/" target="_blank" rel="external">Cyberduck</a></li>
</ul>
<h3 id="吐槽">吐槽</h3><p>NodeBB 通过 node_modules 的方式提供插件，造成静态资源耦合太紧。</p>
]]></content>
    <summary type="html">
    <![CDATA[NodeBB 是一个基于 Node.js 的开源论坛，Metro UI 十分精美，它有以下特点：按照类目，标签，最新等进行帖子分类...]]>
    
    </summary>
    
      <category term="CentOS" scheme="http://blog.smalldragonluo.com/tags/CentOS/"/>
    
      <category term="Nginx" scheme="http://blog.smalldragonluo.com/tags/Nginx/"/>
    
      <category term="Node.js" scheme="http://blog.smalldragonluo.com/tags/Node-js/"/>
    
      <category term="NodeBB" scheme="http://blog.smalldragonluo.com/tags/NodeBB/"/>
    
      <category term="Redis" scheme="http://blog.smalldragonluo.com/tags/Redis/"/>
    
      <category term="论坛" scheme="http://blog.smalldragonluo.com/tags/%E8%AE%BA%E5%9D%9B/"/>
    
      <category term="前端技术" scheme="http://blog.smalldragonluo.com/categories/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[博客迁移]]></title>
    <link href="http://blog.smalldragonluo.com/2015/11/10/%E5%8D%9A%E5%AE%A2%E8%BF%81%E7%A7%BB/"/>
    <id>http://blog.smalldragonluo.com/2015/11/10/博客迁移/</id>
    <published>2015-11-10T06:11:44.000Z</published>
    <updated>2015-12-06T14:19:03.000Z</updated>
    <content type="html"><![CDATA[<p>&ensp;&ensp;今天折腾了下 <a href="https://hexo.io/zh-cn/" target="_blank" rel="external">hexo</a>，顺便把博客迁移到 <a href="//blog.smalldragonluo.com">blog.smalldragonluo.com</a>，从今天起就在这里安家啦~</p>
<p>&ensp;&ensp;服务器是 GitHub Pages，通过 CNAME 解析到 GitHub 服务器，其实对于我这种日 PV 还在个位数的博客来讲，放哪里都一样，而且 GitHub Pages 还慢，唯一的好处大概就是自带版本控制了吧。</p>
<p><a href="https://hexo.io/zh-cn/" target="_blank" rel="external">hexo</a> 有插件可以一键部署到服务器，因此还是挺方便的。</p>
<p>&ensp;&ensp;刚把主题换成 <a href="https://www.haomwei.com/technology/maupassant-hexo.html" target="_blank" rel="external">Maupassant</a>，看起来还不错，比较符合我低调奢华的风格。</p>
<p>&ensp;&ensp;以一句短小精悍的 javascript 代码做结语吧：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'hello world.'</span>);</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[从今天起就在这里安家啦~]]>
    
    </summary>
    
      <category term="GitHub" scheme="http://blog.smalldragonluo.com/tags/GitHub/"/>
    
      <category term="前端技术" scheme="http://blog.smalldragonluo.com/categories/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/"/>
    
  </entry>
  
</feed>
